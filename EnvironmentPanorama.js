/*!
QWebEngine 1.01
https://www.auto00.com
https://www.qiland.com
*/
window.EnvironmentPanorama=function(){"use strict";var e=window.P,t=window.OSG,r=t.osg,a=t.osgDB,n=new t.osgShader.ShaderProcessor,i=function(e,t,r){this._options=r||{},this._size=t,"string"==typeof e?this._file=e:this._data=e};return i.prototype={getFile:function(){return this._file},createShaderPanorama:function(e){if(void 0===this._shaderPanorama){var t=n.getShader("panoramaVertex.glsl"),a=n.getShader("panoramaFragment.glsl",e),i=new r.Program(new r.Shader("VERTEX_SHADER",t),new r.Shader("FRAGMENT_SHADER",a));this._shaderPanorama=i}return this._shaderPanorama},getTexture:function(){return this._texture},deinterleaveImage4:function(e,t,r){for(var a=e*e,n=2*a,i=3*a,s=0,o=0;o<a;o++)r[s++]=t[o],r[s++]=t[o+a],r[s++]=t[o+n],r[s++]=t[o+i]},deinterleaveImage3:function(e,t,r){for(var a=e*e,n=0,i=0;i<a;i++)r[n++]=t[i],r[n++]=t[i+a],r[n++]=t[i+2*a]},loadPacked:function(t){var n=e.defer(),i=function(e){var i=e;a.isGunzipBuffer(i)&&(i=a.gunzip(i));var s,o,h=this._size;"FLOAT"===t?(s=new Float32Array(i),o=new Float32Array(i.byteLength/4),this.deinterleaveImage3(h,s,o)):(s=new Uint8Array(i),o=new Uint8Array(i.byteLength),this.deinterleaveImage4(h,s,o)),s=o;var u=new r.Image;u.setImage(s),u.setWidth(h),u.setHeight(h),"FLOAT"===t?this.createFloatPacked(u):this.createRGBA8Packed(u),n.resolve()}.bind(this);return this._data?i(this._data):(new a.Input).requestFile(this._file,{responseType:"arraybuffer"}).then(i),n.promise},createFloatPacked:function(e){var t=new r.Texture;return t.setMinFilter("LINEAR"),t.setMagFilter("LINEAR"),t.setWrapS("REPEAT"),t.setType("FLOAT"),t.setFlipY(!0),t.setImage(e,"RGB"),this._texture=t,t},createRGBA8Packed:function(e){var t=new r.Texture;return t.setMinFilter("LINEAR"),t.setMagFilter("LINEAR"),t.setWrapS("REPEAT"),t.setFlipY(!0),t.setImage(e,"RGBA"),this._texture=t,t},createRGB:function(e){var t=new r.Texture;return t.setMinFilter("LINEAR"),t.setMagFilter("LINEAR"),t.setWrapS("REPEAT"),t.setFlipY(!0),t.setImage(e,"RGB"),this._texture=t,t}},i}();