!function e(t,r,n){function o(a,s){if(!r[a]){if(!t[a]){var d="function"==typeof require&&require;if(!s&&d)return d(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var u=r[a]={exports:{}};t[a][0].call(u.exports,function(e){var r=t[a][1][e];return o(r||e)},u,u.exports,e,t,r,n)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,t,r){self.dagreD3=e("./index")},{"./index":2}],2:[function(e,t,r){t.exports={Digraph:e("graphlib").Digraph,Graph:e("graphlib").Graph,Renderer:e("./lib/Renderer"),json:e("graphlib").converter.json,layout:e("dagre").layout,version:e("./lib/version"),debug:e("dagre").debug}},{"./lib/Renderer":3,"./lib/version":4,dagre:11,graphlib:29}],3:[function(e,t,r){function n(){this._layout=F(),this.drawNodes(d),this.drawEdgeLabels(u),this.drawEdgePaths(U),this.positionNodes(c),this.positionEdgeLabels(h),this.positionEdgePaths(v),this.zoomSetup(E),this.zoom(m),this.transition(y),this.postLayout(_),this.postRender(b),this.edgeInterpolate("bundle"),this.edgeTension(.95)}function o(e){var t=e.copy();return void 0===t.graph()&&t.graph({}),"arrowheadFix"in t.graph()||(t.graph().arrowheadFix=!0),t.nodes().forEach(function(e){var r=i(t.node(e));t.node(e,r),"label"in r||(r.label="")}),t.edges().forEach(function(e){var r=i(t.edge(e));t.edge(e,r),"label"in r||(r.label="")}),t}function i(e){var t={};for(var r in e)t[r]=e[r];return t}function a(e,t){var r=e.getBBox();t.width=r.width,t.height=r.height}function s(e,t){var r=t.run(e);return e.eachNode(function(e,t){r.node(e).label=t.label}),e.eachEdge(function(e,t,n,o){r.edge(e).label=o.label}),r}function d(e,t){var r=e.nodes().filter(function(t){return!z(e,t)}),n=t.selectAll("g.node").classed("enter",!1).data(r,function(e){return e});return n.selectAll("*").remove(),n.enter().append("g").style("opacity",0).attr("class","node enter"),n.each(function(t){w(e.node(t),V.select(this),!0,10,10)}),this._transition(n.exit()).style("opacity",0).remove(),n}function u(e,t){var r=t.selectAll("g.edgeLabel").classed("enter",!1).data(e.edges(),function(e){return e});return r.selectAll("*").remove(),r.enter().append("g").style("opacity",0).attr("class","edgeLabel enter"),r.each(function(t){w(e.edge(t),V.select(this),!1,0,0)}),this._transition(r.exit()).style("opacity",0).remove(),r}function c(e,t){function r(t){var r=e.node(t);return"translate("+r.x+","+r.y+")"}t.filter(".enter").attr("transform",r),this._transition(t).style("opacity",1).attr("transform",r)}function h(e,t){function r(t){var r=D(e.edge(t).points);return"translate("+r.x+","+r.y+")"}t.filter(".enter").attr("transform",r),this._transition(t).style("opacity",1).attr("transform",r)}function l(e){return"[object SVGEllipseElement]"===Object.prototype.toString.call(e)}function f(e){return"[object SVGCircleElement]"===Object.prototype.toString.call(e)}function p(e){return"[object SVGPolygonElement]"===Object.prototype.toString.call(e)}function g(e,t,r){if(e.useDef){var n=r.select("defs #"+e.useDef).node();if(n){var o=n.childNodes[0];if(f(o)||l(o))return M(e,o,t);if(p(o))return R(e,o,t)}}return I(e,t)}function v(e,t,r){function n(t){var n=e.edge(t),a=e.node(e.incidentNodes(t)[0]),s=e.node(e.incidentNodes(t)[1]),d=n.points.slice(),u=0===d.length?s:d[0],c=0===d.length?a:d[d.length-1];return d.unshift(g(a,u,r)),d.push(g(s,c,r)),V.svg.line().x(function(e){return e.x}).y(function(e){return e.y}).interpolate(o).tension(i)(d)}var o=this._edgeInterpolate,i=this._edgeTension;t.filter(".enter").selectAll("path").attr("d",n),this._transition(t.selectAll("path")).attr("d",n).style("opacity",1)}function y(e){return e}function E(e,t){var r=t.property("ownerSVGElement");return(r=r?V.select(r):t).select("rect.overlay").empty()&&(r.insert("rect",":first-child").attr("class","overlay").attr("width","100%").attr("height","100%").style("fill","none").style("pointer-events","all"),t=t.append("g").attr("class","zoom"),this._zoom&&r.call(this._zoom(e,t))),t}function m(e,t){return V.behavior.zoom().on("zoom",function(){t.attr("transform","translate("+V.event.translate+")scale("+V.event.scale+")")})}function _(){}function b(e,t){e.isDirected()&&k(t,"arrowhead").attr("fill","#333")}function k(e,t){var r=e.select("#"+t);if(!r.empty())return r;var n=e.select("defs");n.empty()&&(n=e.append("svg:defs"));var o=n.append("svg:marker").attr("id",t).attr("viewBox","0 0 10 10").attr("refX",8).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",5).attr("orient","auto");return o.append("svg:path").attr("d","M 0 0 L 10 5 L 0 10 z"),o}function w(e,t,r,n,o){if(e.useDef)t.append("use").attr("xlink:href","#"+e.useDef);else{var i=e.label,a=t.append("rect");e.width&&a.attr("width",e.width),e.height&&a.attr("height",e.height);var s,d=t.append("g");"string"==typeof i?"<"===i[0]?(x(i,d),n=o=0):(s=G(i,d,Math.floor(e.labelCols),e.labelCut),P(e.labelStyle,s)):"function"==typeof i?(S(i,d),n=o=0):"object"==typeof i&&(L(i,d),n=o=0);var u=d.node().getBBox();d.attr("transform","translate("+-u.width/2+","+-u.height/2+")");var c=t.node().getBBox();a.attr("rx",e.rx?e.rx:5).attr("ry",e.ry?e.ry:5).attr("x",-(c.width/2+n)).attr("y",-(c.height/2+o)).attr("width",c.width+2*n).attr("height",c.height+2*o).attr("fill","#fff"),r&&(P(e.style,a),e.fill&&a.style("fill",e.fill),e.stroke&&a.style("stroke",e.stroke),e["stroke-width"]&&a.style("stroke-width",e["stroke-width"]+"px"),e["stroke-dasharray"]&&a.style("stroke-dasharray",e["stroke-dasharray"]),e.href&&t.attr("class",t.attr("class")+" clickable").on("click",function(){window.open(e.href)}))}}function N(e,t){var r=t.append("foreignObject").attr("width","100000"),n=r.append("xhtml:div").style("float","left");e(n);var o,i;n.each(function(){o=this.clientWidth,i=this.clientHeight}),r.attr("width",o).attr("height",i)}function x(e,t){N(function(t){t.html(function(){return e})},t)}function S(e,t){N(function(t){t.insert(e)},t)}function L(e,t){S(function(){return e},t)}function G(e,t,r,n){void 0===n&&(n="false"),n="true"===n.toString().toLowerCase();var o=t.append("text").attr("text-anchor","left");e=e.replace(/\\n/g,"\n");var i=r?A(e,r,n):e;i=i.split("\n");for(var a=0;a<i.length;a++)o.append("tspan").attr("dy","1em").attr("x","1").text(i[a]);return o}function A(e,t,r,n){if(n=n||"\n",t=t||75,r=r||!1,!e)return e;var o=".{1,"+t+"}(\\s|$)"+(r?"|.{"+t+"}|.+$":"|\\S+?(\\s|$)");return e.match(new RegExp(o,"g")).join(n)}function D(e){var t=e.length/2;if(e.length%2)return e[Math.floor(t)];var r=e[t-1],n=e[t];return{x:(r.x+n.x)/2,y:(r.y+n.y)/2}}function I(e,t){var r,n,o=e.x,i=e.y,a=t.x-o,s=t.y-i,d=e.width/2,u=e.height/2;return Math.abs(s)*d>Math.abs(a)*u?(s<0&&(u=-u),r=0===s?0:u*a/s,n=u):(a<0&&(d=-d),r=d,n=0===a?0:d*s/a),{x:o+r,y:i+n}}function M(e,t,r){var n,o,i=e.x,a=e.y;f(t)?n=o=t.r.baseVal.value:(n=t.rx.baseVal.value,o=t.ry.baseVal.value);var s=i-r.x,d=a-r.y,u=Math.sqrt(n*n*d*d+o*o*s*s),c=Math.abs(n*o*s/u);r.x<i&&(c=-c);var h=Math.abs(n*o*d/u);return r.y<a&&(h=-h),{x:i+c,y:a+h}}function C(e,t){return e*t>0}function j(e,t,r){r.some(function(r){return r[0]===e&&r[1]===t})||r.push([e,t])}function O(e,t,r,n,o,i,a,s,d){var u,c,h,l,f,p,g,v,y,E,m,_,b;E=(u=n-t)*a+(h=e-r)*s+(f=r*t-e*n),0!==(y=u*o+h*i+f)&&0!==E&&C(y,E)||(v=(c=s-i)*r+(l=o-a)*n+(p=a*i-o*s),0!==(g=c*e+l*t+p)&&0!==v&&C(g,v)||0!==(m=u*l-c*h)&&(_=Math.abs(m/2),j((b=h*p-l*f)<0?(b-_)/m:(b+_)/m,(b=c*f-u*p)<0?(b-_)/m:(b+_)/m,d)))}function R(e,t,r){for(var n=e.x,o=e.y,i=r.x,a=r.y,s=[],d=t.points,u=1e5,c=1e5,h=0;h<d.numberOfItems;h++){var l=d.getItem(h);u=Math.min(u,l.x),c=Math.min(c,l.y)}for(var f=n-e.width/2-u,p=o-e.height/2-c,g=0;g<d.numberOfItems;g++){var v=d.getItem(g),y=d.getItem(g<d.numberOfItems-1?g+1:0);O(n,o,i,a,f+v.x,p+v.y,f+y.x,p+y.y,s)}return 1===s.length?{x:s[0][0],y:s[0][1]}:s.length>1?(s.sort(function(e,t){var n=e[0]-r.x,o=e[1]-r.y,i=Math.sqrt(n*n+o*o),a=t[0]-r.x,s=t[1]-r.y,d=Math.sqrt(a*a+s*s);return i<d?-1:i===d?0:1}),{x:s[0][0],y:s[0][1]}):(console.log("NO INTERSECTION FOUND, RETURN NODE CENTER",e),e)}function z(e,t){return"children"in e&&e.children(t).length}function T(e,t){return e.bind?e.bind(t):function(){return e.apply(t,arguments)}}function P(e,t){if(e){var r=t.attr("style")||"";t.attr("style",r+"; "+e)}}var V,F=e("dagre").layout;try{V=e("d3")}catch(e){V=window.d3}t.exports=n,n.prototype.layout=function(e){return arguments.length?(this._layout=e,this):this._layout},n.prototype.drawNodes=function(e){return arguments.length?(this._drawNodes=T(e,this),this):this._drawNodes},n.prototype.drawEdgeLabels=function(e){return arguments.length?(this._drawEdgeLabels=T(e,this),this):this._drawEdgeLabels},n.prototype.drawEdgePaths=function(e){return arguments.length?(this._drawEdgePaths=T(e,this),this):this._drawEdgePaths},n.prototype.positionNodes=function(e){return arguments.length?(this._positionNodes=T(e,this),this):this._positionNodes},n.prototype.positionEdgeLabels=function(e){return arguments.length?(this._positionEdgeLabels=T(e,this),this):this._positionEdgeLabels},n.prototype.positionEdgePaths=function(e){return arguments.length?(this._positionEdgePaths=T(e,this),this):this._positionEdgePaths},n.prototype.transition=function(e){return arguments.length?(this._transition=T(e,this),this):this._transition},n.prototype.zoomSetup=function(e){return arguments.length?(this._zoomSetup=T(e,this),this):this._zoomSetup},n.prototype.zoom=function(e){return arguments.length?(e?this._zoom=T(e,this):delete this._zoom,this):this._zoom},n.prototype.postLayout=function(e){return arguments.length?(this._postLayout=T(e,this),this):this._postLayout},n.prototype.postRender=function(e){return arguments.length?(this._postRender=T(e,this),this):this._postRender},n.prototype.edgeInterpolate=function(e){return arguments.length?(this._edgeInterpolate=e,this):this._edgeInterpolate},n.prototype.edgeTension=function(e){return arguments.length?(this._edgeTension=e,this):this._edgeTension},n.prototype.run=function(e,t){e=o(e);var r=this._zoomSetup(e,t);r.selectAll("g.edgePaths, g.edgeLabels, g.nodes").data(["edgePaths","edgeLabels","nodes"]).enter().append("g").attr("class",function(e){return e});var n=this._drawNodes(e,r.select("g.nodes")),i=this._drawEdgeLabels(e,r.select("g.edgeLabels"));n.each(function(t){a(this,e.node(t))}),i.each(function(t){a(this,e.edge(t))});var d=s(e,this._layout);e.eachNode(function(e,t){t.useDef&&(d.node(e).useDef=t.useDef)}),this._postLayout(d,r);var u=this._drawEdgePaths(e,r.select("g.edgePaths"));return this._positionNodes(d,n),this._positionEdgeLabels(d,i),this._positionEdgePaths(d,u,t),this._postRender(d,r),d};var U=function(e,t){var r=t.selectAll("g.edgePath").classed("enter",!1).data(e.edges(),function(e){return e}),n="url(#arrowhead)";return e.isDirected()?"false"!==e.graph().arrowheadFix&&!1!==e.graph().arrowheadFix&&(n=function(){var e=V.select(this).style("stroke");if(e){var r="arrowhead-"+e.replace(/[^a-zA-Z0-9]/g,"_");return k(t,r).style("fill",e),"url(#"+r+")"}return"url(#arrowhead)"}):n=null,r.enter().append("g").attr("class","edgePath enter").append("path").style("opacity",0),r.selectAll("path").each(function(t){P(e.edge(t).style,V.select(this))}).attr("marker-end",n),this._transition(r.exit()).style("opacity",0).remove(),r}},{d3:10,dagre:11}],4:[function(e,t,r){t.exports="0.2.10-pre"},{}],5:[function(e,t,r){r.Set=e("./lib/Set"),r.PriorityQueue=e("./lib/PriorityQueue"),r.version=e("./lib/version")},{"./lib/PriorityQueue":6,"./lib/Set":7,"./lib/version":9}],6:[function(e,t,r){function n(){this._arr=[],this._keyIndices={}}t.exports=n,n.prototype.size=function(){return this._arr.length},n.prototype.keys=function(){return this._arr.map(function(e){return e.key})},n.prototype.has=function(e){return e in this._keyIndices},n.prototype.priority=function(e){var t=this._keyIndices[e];if(void 0!==t)return this._arr[t].priority},n.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},n.prototype.add=function(e,t){var r=this._keyIndices;if(!(e in r)){var n=this._arr,o=n.length;return r[e]=o,n.push({key:e,priority:t}),this._decrease(o),!0}return!1},n.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},n.prototype.decrease=function(e,t){var r=this._keyIndices[e];if(t>this._arr[r].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[r].priority+" New: "+t);this._arr[r].priority=t,this._decrease(r)},n.prototype._heapify=function(e){var t=this._arr,r=2*e,n=r+1,o=e;r<t.length&&(o=t[r].priority<t[o].priority?r:o,n<t.length&&(o=t[n].priority<t[o].priority?n:o),o!==e&&(this._swap(e,o),this._heapify(o)))},n.prototype._decrease=function(e){for(var t,r=this._arr,n=r[e].priority;0!==e&&(t=e>>1,!(r[t].priority<n));)this._swap(e,t),e=t},n.prototype._swap=function(e,t){var r=this._arr,n=this._keyIndices,o=r[e],i=r[t];r[e]=i,r[t]=o,n[i.key]=e,n[o.key]=t}},{}],7:[function(e,t,r){function n(e){if(this._size=0,this._keys={},e)for(var t=0,r=e.length;t<r;++t)this.add(e[t])}function o(e){var t,r=Object.keys(e),n=r.length,o=new Array(n);for(t=0;t<n;++t)o[t]=e[r[t]];return o}var i=e("./util");t.exports=n,n.intersect=function(e){if(0===e.length)return new n;for(var t=new n(i.isArray(e[0])?e[0]:e[0].keys()),r=1,o=e.length;r<o;++r)for(var a=t.keys(),s=i.isArray(e[r])?new n(e[r]):e[r],d=0,u=a.length;d<u;++d){var c=a[d];s.has(c)||t.remove(c)}return t},n.union=function(e){for(var t=i.reduce(e,function(e,t){return e+(t.size?t.size():t.length)},0),r=new Array(t),o=0,a=0,s=e.length;a<s;++a)for(var d=e[a],u=i.isArray(d)?d:d.keys(),c=0,h=u.length;c<h;++c)r[o++]=u[c];return new n(r)},n.prototype.size=function(){return this._size},n.prototype.keys=function(){return o(this._keys)},n.prototype.has=function(e){return e in this._keys},n.prototype.add=function(e){return!(e in this._keys)&&(this._keys[e]=e,++this._size,!0)},n.prototype.remove=function(e){return e in this._keys&&(delete this._keys[e],--this._size,!0)}},{"./util":8}],8:[function(e,t,r){Array.isArray?r.isArray=Array.isArray:r.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},"function"!=typeof Array.prototype.reduce?r.reduce=function(e,t,r){"use strict";if(null===e||void 0===e)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var n,o,i=e.length>>>0,a=!1;for(1<arguments.length&&(o=r,a=!0),n=0;i>n;++n)e.hasOwnProperty(n)&&(a?o=t(o,e[n],n,e):(o=e[n],a=!0));if(!a)throw new TypeError("Reduce of empty array with no initial value");return o}:r.reduce=function(e,t,r){return e.reduce(t,r)}},{}],9:[function(e,t,r){t.exports="1.1.3"},{}],10:[function(e,t,r){e("./d3"),t.exports=d3,function(){delete this.d3}()},{}],11:[function(e,t,r){r.Digraph=e("graphlib").Digraph,r.Graph=e("graphlib").Graph,r.layout=e("./lib/layout"),r.version=e("./lib/version"),r.debug=e("./lib/debug")},{"./lib/debug":12,"./lib/layout":13,"./lib/version":28,graphlib:29}],12:[function(e,t,r){"use strict";var n=e("./util");r.dotOrdering=function(e){function t(r){var n=e.children(r);n.length?(o+="subgraph cluster_"+r+" {",o+='label="'+r+'";',n.forEach(function(e){t(e)}),o+="}"):(o+=r,e.node(r).dummy&&(o+=" [shape=diamond]"),o+=";")}var r=n.ordering(e.filterNodes(n.filterNonSubgraphs(e))),o="digraph {";return e.children(null).forEach(t),r.forEach(function(e){o+='subgraph { rank=same; edge [style="invis"];',o+=e.join("->"),o+="}"}),e.eachEdge(function(e,t,r){o+=t+"->"+r+";"}),o+="}"}},{"./util":27}],13:[function(e,t,r){"use strict";var n=e("./util"),o=e("./rank"),i=e("./order"),a=e("graphlib").CGraph,s=e("graphlib").CDigraph;t.exports=function(){function t(e){var t=new s;e.eachNode(function(e,r){void 0===r&&(r={}),t.addNode(e,{width:r.width,height:r.height}),r.hasOwnProperty("rank")&&(t.node(e).prefRank=r.rank)}),e.parent&&e.nodes().forEach(function(r){t.parent(r,e.parent(r))}),e.eachEdge(function(e,r,n,o){void 0===o&&(o={});var i={e:e,minLen:o.minLen||1,width:o.width||0,height:o.height||0,points:[]};t.addEdge(null,r,n,i)});var r=e.graph()||{};return t.graph({rankDir:r.rankDir||l.rankDir,orderRestarts:r.orderRestarts}),t}function r(e){var t=0;e.eachEdge(function(r,n,o,i){var a=e.node(n).rank,s=e.node(o).rank;if(a+1<s){for(var d=n,u=a+1,c=0;u<s;++u,++c){var h="_D"+ ++t,l={width:i.width,height:i.height,edge:{id:r,source:n,target:o,attrs:i},rank:u,dummy:!0};0===c?l.index=0:u+1===s&&(l.index=1),e.addNode(h,l),e.addEdge(null,d,h,{}),d=h}e.addEdge(null,d,o,{}),e.delEdge(r)}})}function d(e){e.eachNode(function(t,r){if(r.dummy){if("index"in r){var n=r.edge;e.hasEdge(n.id)||e.addEdge(n.id,n.source,n.target,n.attrs),e.edge(n.id).points[r.index]={x:r.x,y:r.y,ul:r.ul,ur:r.ur,dl:r.dl,dr:r.dr}}e.delNode(t)}})}function u(e){e.eachEdge(function(e,t,r,n){n.reversed&&n.points.reverse()})}function c(e,t){var r=t?new s:new a;r.graph(e.graph()),e.eachNode(function(e,t){r.addNode(e,t)}),e.eachNode(function(t){r.parent(t,e.parent(t))}),e.eachEdge(function(e,t,n,o){r.addEdge(o.e,t,n,o)});var n=0,o=0;return e.eachNode(function(t,r){e.children(t).length||(n=Math.max(n,r.x+r.width/2),o=Math.max(o,r.y+r.height/2))}),e.eachEdge(function(e,t,r,i){var a=Math.max.apply(Math,i.points.map(function(e){return e.x})),s=Math.max.apply(Math,i.points.map(function(e){return e.y}));n=Math.max(n,a+i.width/2),o=Math.max(o,s+i.height/2)}),r.graph().width=n,r.graph().height=o,r}function h(e){return function(){return arguments.length?(e.apply(null,arguments),p):e()}}var l={debugLevel:0,orderMaxSweeps:i.DEFAULT_MAX_SWEEPS,rankSimplex:!1,rankDir:"TB"},f=e("./position")(),p={};return p.orderIters=n.propertyAccessor(p,l,"orderMaxSweeps"),p.rankSimplex=n.propertyAccessor(p,l,"rankSimplex"),p.nodeSep=h(f.nodeSep),p.edgeSep=h(f.edgeSep),p.universalSep=h(f.universalSep),p.rankSep=h(f.rankSep),p.rankDir=n.propertyAccessor(p,l,"rankDir"),p.debugAlignment=h(f.debugAlignment),p.debugLevel=n.propertyAccessor(p,l,"debugLevel",function(e){n.log.level=e,f.debugLevel(e)}),p.run=n.time("Total layout",function(e){var a,s=p.rankSep();try{return 0===(a=n.time("initLayoutGraph",t)(e)).order()?a:(a.eachEdge(function(e,t,r,n){n.minLen*=2}),p.rankSep(s/2),n.time("rank.run",o.run)(a,l.rankSimplex),n.time("normalize",r)(a),n.time("order",i)(a,l.orderMaxSweeps),n.time("position",f.run)(a),n.time("undoNormalize",d)(a),n.time("fixupEdgePoints",u)(a),n.time("rank.restoreEdges",o.restoreEdges)(a),n.time("createFinalGraph",c)(a,e.isDirected()))}finally{p.rankSep(s)}}),p._normalize=r,p}},{"./order":14,"./position":19,"./rank":20,"./util":27,graphlib:29}],14:[function(e,t,r){"use strict";function n(e,t){arguments.length<2&&(t=p);var r=e.graph().orderRestarts||0,n=h(e);n.forEach(function(t){t=t.filterNodes(function(t){return!e.children(t).length})});for(var o,i=0,s=Number.MAX_VALUE,d={},f=0;f<Number(r)+1&&0!==s;++f){o=Number.MAX_VALUE,l(e,r>0),u.log(2,"Order phase start cross count: "+e.graph().orderInitCC);var g,v,y;for(g=0,v=0;v<4&&g<t&&o>0;++g,++v,++i)a(e,n,g),(y=c(e))<o&&(v=0,o=y,y<s&&(e.eachNode(function(e,t){d[e]=t.order}),s=y)),u.log(3,"Order phase start "+f+" iter "+g+" cross count: "+y)}Object.keys(d).forEach(function(t){e.children&&e.children(t).length||(e.node(t).order=d[t])}),e.graph().orderCC=s,u.log(2,"Order iterations: "+i),u.log(2,"Order phase best cross count: "+e.graph().orderCC)}function o(e,t){var r={};return t.forEach(function(t){r[t]=e.inEdges(t).map(function(t){return e.node(e.source(t)).order})}),r}function i(e,t){var r={};return t.forEach(function(t){r[t]=e.outEdges(t).map(function(t){return e.node(e.target(t)).order})}),r}function a(e,t,r){r%2==0?s(e,t):d(e,t)}function s(e,t){for(var r,n=1;n<t.length;++n)r=f(t[n],r,o(e,t[n].nodes()))}function d(e,t){for(var r=t.length-2;r>=0;--r)f(t[r],void 0,i(e,t[r].nodes()))}var u=e("./util"),c=e("./order/crossCount"),h=e("./order/initLayerGraphs"),l=e("./order/initOrder"),f=e("./order/sortLayer");t.exports=n;var p=24;n.DEFAULT_MAX_SWEEPS=p},{"./order/crossCount":15,"./order/initLayerGraphs":16,"./order/initOrder":17,"./order/sortLayer":18,"./util":27}],15:[function(e,t,r){"use strict";function n(e,t,r){var n=[];t.forEach(function(t){var r=[];e.outEdges(t).forEach(function(t){r.push(e.node(e.target(t)).order)}),r.sort(function(e,t){return e-t}),n=n.concat(r)});for(var o=1;o<r.length;)o<<=1;var i=2*o-1;o-=1;for(var a=[],s=0;s<i;++s)a[s]=0;var d=0;return n.forEach(function(e){var t=e+o;for(++a[t];t>0;)t%2&&(d+=a[t+1]),++a[t=t-1>>1]}),d}var o=e("../util");t.exports=function(e){for(var t=0,r=o.ordering(e),i=1;i<r.length;++i)t+=n(e,r[i-1],r[i]);return t}},{"../util":27}],16:[function(e,t,r){"use strict";var n=e("graphlib").filter.nodesFromList,o=e("cp-data").Set;t.exports=function(e){function t(n){if(null!==n){var i=e.node(n);i.minRank="rank"in i?i.rank:Number.MAX_VALUE,i.maxRank="rank"in i?i.rank:Number.MIN_VALUE;var a=new o;return e.children(n).forEach(function(r){var n=t(r);a=o.union([a,n]),i.minRank=Math.min(i.minRank,e.node(r).minRank),i.maxRank=Math.max(i.maxRank,e.node(r).maxRank)}),"rank"in i&&a.add(i.rank),a.keys().forEach(function(e){e in r||(r[e]=[]),r[e].push(n)}),a}e.children(n).forEach(function(e){t(e)})}var r=[];t(null);var i=[];return r.forEach(function(t,r){i[r]=e.filterNodes(n(t))}),i}},{"cp-data":5,graphlib:29}],17:[function(e,t,r){"use strict";var n=e("./crossCount"),o=e("../util");t.exports=function(e,t){var r=[];e.eachNode(function(t,n){var o=r[n.rank];e.children&&e.children(t).length>0||(o||(o=r[n.rank]=[]),o.push(t))}),r.forEach(function(r){t&&o.shuffle(r),r.forEach(function(t,r){e.node(t).order=r})});var i=n(e);e.graph().orderInitCC=i,e.graph().orderCC=Number.MAX_VALUE}},{"../util":27,"./crossCount":15}],18:[function(e,t,r){"use strict";function n(e,t,r,i){r=r?r.filterNodes(l(e.children(t))):new c;var s={};e.children(t).forEach(function(t){if(e.children(t).length)s[t]=n(e,t,r,i),s[t].firstSG=t,s[t].lastSG=t;else{var o=i[t];s[t]={degree:o.length,barycenter:u.sum(o)/o.length,order:e.node(t).order,orderCount:1,list:[t]}}}),a(e,r,s);var d=Object.keys(s);return d.sort(function(e,t){return s[e].barycenter-s[t].barycenter||s[e].order-s[t].order}),d.map(function(e){return s[e]}).reduce(function(t,r){return o(e,t,r)})}function o(e,t,r){var n=i(t.constraintGraph,r.constraintGraph);return void 0!==t.lastSG&&void 0!==r.firstSG&&(void 0===n&&(n=new c),n.hasNode(t.lastSG)||n.addNode(t.lastSG),n.addNode(r.firstSG),n.addEdge(null,t.lastSG,r.firstSG)),{degree:t.degree+r.degree,barycenter:(t.barycenter*t.degree+r.barycenter*r.degree)/(t.degree+r.degree),order:(t.order*t.orderCount+r.order*r.orderCount)/(t.orderCount+r.orderCount),orderCount:t.orderCount+r.orderCount,list:t.list.concat(r.list),firstSG:void 0!==t.firstSG?t.firstSG:r.firstSG,lastSG:void 0!==r.lastSG?r.lastSG:t.lastSG,constraintGraph:n}}function i(e,t){return void 0===e?t:void 0===t?e:(e=e.copy(),t.nodes().forEach(function(t){e.addNode(t)}),t.edges().forEach(function(t,r,n){e.addEdge(null,r,n)}),e)}function a(e,t,r){for(var n;void 0!==(n=s(t,r));){for(var i,a=t.source(n),d=t.target(n);(i=t.addNode(null))&&e.hasNode(i);)t.delNode(i);r[i]=o(e,r[a],r[d]),delete r[a],delete r[d],function(e,r,n){t.inEdges(e).forEach(function(e){t.delEdge(e),t.addEdge(null,t.source(e),n)}),t.outEdges(r).forEach(function(e){t.delEdge(e),t.addEdge(null,n,t.target(e))}),t.delNode(e),t.delNode(r)}(a,d,i),0===t.incidentEdges(i).length&&t.delNode(i)}}function s(e,t){for(var r=h(e),n=0;n<r.length;++n)for(var o=r[n],i=e.inEdges(o),a=0;a<i.length;++a){var s=i[a];if(t[e.source(s)].barycenter>=t[o].barycenter)return s}}function d(e,t){var r=Number.MAX_VALUE,n=0,o={};e.eachNode(function(o){if(!e.children(o).length){var i=t[o];i.length&&(r=Math.min(r,u.min(i)),n=Math.max(n,u.max(i)))}});var i=n-r;return e.eachNode(function(n){if(!e.children(n).length){var a=t[n];a.length?o[n]=a.map(function(t){return i?(t-r)*(e.order()-1)/i:e.order()-.5}):o[n]=[e.node(n).order]}}),o}var u=e("../util"),c=e("graphlib").Digraph,h=e("graphlib").alg.topsort,l=e("graphlib").filter.nodesFromList;t.exports=function(e,t,r){r=d(e,r);var o=n(e,null,t,r);return o.list.forEach(function(t,r){e.node(t).order=r}),o.constraintGraph}},{"../util":27,graphlib:29}],19:[function(e,t,r){"use strict";var n=e("./util");t.exports=function(){function e(e,t){return e<t?e.toString().length+":"+e+"-"+t:t.toString().length+":"+t+"-"+e}function t(t,r){var n,o,i,a,s,d={},u={};if(r.length<=2)return d;r[1].forEach(function(e,t){u[e]=t});for(var c=1;c<r.length-1;++c){n=r[c],o=r[c+1],i=0,a=0;for(var h=0;h<o.length;++h){var l=o[h];if(u[l]=h,s=void 0,t.node(l).dummy){var f=t.predecessors(l)[0];void 0!==f&&t.node(f).dummy&&(s=u[f])}if(void 0===s&&h===o.length-1&&(s=n.length-1),void 0!==s){for(;a<=h;++a)t.predecessors(o[a]).forEach(function(t){var r=u[t];(r<i||r>s)&&(d[e(o[a],t)]=!0)});i=s}}}return d}function r(t,r,n,o){var i={},a={},s={};return r.forEach(function(e){e.forEach(function(e,t){a[e]=e,s[e]=e,i[e]=t})}),r.forEach(function(r){var d=-1;r.forEach(function(r){var u,c=t[o](r);c.length>0&&(c.sort(function(e,t){return i[e]-i[t]}),u=(c.length-1)/2,c.slice(Math.floor(u),Math.ceil(u)+1).forEach(function(t){s[r]===r&&!n[e(t,r)]&&d<i[t]&&(s[t]=r,s[r]=a[r]=a[t],d=i[t])}))})}),{pos:i,root:a,align:s}}function o(e,t,r,o,i){function a(e,t,r){t in u[e]?u[e][t]=Math.min(u[e][t],r):u[e][t]=r}function s(t){if(!(t in f)){f[t]=0;var n=t;do{if(r[n]>0){var u=o[h[n]];s(u),d[t]===t&&(d[t]=d[u]);var c=l(e,h[n])+l(e,n);d[t]!==d[u]?a(d[u],d[t],f[t]-f[u]-c):f[t]=Math.max(f[t],f[u]+c)}n=i[n]}while(n!==t)}}var d={},u={},c={},h={},f={};return t.forEach(function(e){e.forEach(function(t,r){d[t]=t,u[t]={},r>0&&(h[t]=e[r-1])})}),n.values(o).forEach(function(e){s(e)}),t.forEach(function(e){e.forEach(function(e){if(f[e]=f[o[e]],e===o[e]&&e===d[e]){var t=0;e in u&&Object.keys(u[e]).length>0&&(t=n.min(Object.keys(u[e]).map(function(t){return u[e][t]+(t in c?c[t]:0)}))),c[e]=t}})}),t.forEach(function(e){e.forEach(function(e){f[e]+=c[d[o[e]]]||0})}),f}function i(e,t,r){return n.min(t.map(function(e){var t=e[0];return r[t]}))}function a(e,t,r){return n.max(t.map(function(e){var t=e[e.length-1];return r[t]}))}function s(e,t,r){var n,o={},s={},d={},u=Number.POSITIVE_INFINITY;for(var c in r){var h=r[c];o[c]=i(e,t,h),s[c]=a(e,t,h);var l=s[c]-o[c];l<u&&(u=l,n=c)}["u","d"].forEach(function(e){["l","r"].forEach(function(t){var r=e+t;d[r]="l"===t?o[n]-o[r]:s[n]-s[r]})});for(c in r)e.eachNode(function(e){r[c][e]+=d[c]})}function d(e){for(var t in e)e[t]=-e[t]}function u(e){e.forEach(function(e){e.reverse()})}function c(e,t){switch(e.graph().rankDir){case"LR":case"RL":return e.node(t).height;default:return e.node(t).width}}function h(e,t){switch(e.graph().rankDir){case"LR":case"RL":return e.node(t).width;default:return e.node(t).height}}function l(e,t){return null!==y.universalSep?y.universalSep:(c(e,t)+(e.node(t).dummy?y.edgeSep:y.nodeSep))/2}function f(e,t,r){if("LR"===e.graph().rankDir||"RL"===e.graph().rankDir){if(arguments.length<3)return e.node(t).y;e.node(t).y=r}else{if(arguments.length<3)return e.node(t).x;e.node(t).x=r}}function p(e,t,r,n){if("LR"===t.graph().rankDir||"RL"===t.graph().rankDir){if(arguments.length<3)return t.node(r)[e];t.node(r)[e]=n}else{if(arguments.length<3)return t.node(r)[e];t.node(r)[e]=n}}function g(e,t,r){if("LR"===e.graph().rankDir||"RL"===e.graph().rankDir){if(arguments.length<3)return e.node(t).x;e.node(t).x=r}else{if(arguments.length<3)return e.node(t).y;e.node(t).y=r}}function v(e,t,r,n){r.forEach(function(r,o){var i,a;r.forEach(function(r){var s=n[r];if(i){var d=l(t,i)+l(t,r);s-a<d&&console.log("Position phase: sep violation. Align: "+e+". Layer: "+o+". U: "+i+" V: "+r+". Actual sep: "+(s-a)+" Expected sep: "+d)}i=r,a=s})})}var y={nodeSep:50,edgeSep:10,universalSep:null,rankSep:30},E={};return E.nodeSep=n.propertyAccessor(E,y,"nodeSep"),E.edgeSep=n.propertyAccessor(E,y,"edgeSep"),E.universalSep=n.propertyAccessor(E,y,"universalSep"),E.rankSep=n.propertyAccessor(E,y,"rankSep"),E.debugLevel=n.propertyAccessor(E,y,"debugLevel"),E.run=function(e){e=e.filterNodes(n.filterNonSubgraphs(e));var i=n.ordering(e),a=t(e,i),l={};["u","d"].forEach(function(t){"d"===t&&i.reverse(),["l","r"].forEach(function(n){"r"===n&&u(i);var s=t+n,c=r(e,i,a,"u"===t?"predecessors":"successors");l[s]=o(e,i,c.pos,c.root,c.align),y.debugLevel>=3&&v(t+n,e,i,l[s]),"r"===n&&d(l[s]),"r"===n&&u(i)}),"d"===t&&i.reverse()}),s(e,i,l),e.eachNode(function(t){var r=[];for(var n in l){var o=l[n][t];p(n,e,t,o),r.push(o)}r.sort(function(e,t){return e-t}),f(e,t,(r[1]+r[2])/2)});var E=0,m="BT"===e.graph().rankDir||"RL"===e.graph().rankDir;i.forEach(function(t){var r=n.max(t.map(function(t){return h(e,t)}));E+=r/2,t.forEach(function(t){g(e,t,m?-E:E)}),E+=r/2+y.rankSep});var _=n.min(e.nodes().map(function(t){return f(e,t)-c(e,t)/2})),b=n.min(e.nodes().map(function(t){return g(e,t)-h(e,t)/2}));e.eachNode(function(t){f(e,t,f(e,t)-_),g(e,t,g(e,t)-b)})},E}},{"./util":27}],20:[function(e,t,r){"use strict";function n(e){e.eachEdge(function(t,r,n,o){if(r===n){var a=i(e,t,r,n,o,0,!1),s=i(e,t,r,n,o,1,!0),d=i(e,t,r,n,o,2,!1);e.addEdge(null,a,r,{minLen:1,selfLoop:!0}),e.addEdge(null,a,s,{minLen:1,selfLoop:!0}),e.addEdge(null,r,d,{minLen:1,selfLoop:!0}),e.addEdge(null,s,d,{minLen:1,selfLoop:!0}),e.delEdge(t)}})}function o(e){e.eachEdge(function(t,r,n,o){if(r===n){var a=o.originalEdge,s=i(e,a.e,a.u,a.v,a.value,0,!0);e.addEdge(null,r,s,{minLen:1}),e.addEdge(null,s,n,{minLen:1}),e.delEdge(t)}})}function i(e,t,r,n,o,i,a){return e.addNode(null,{width:a?o.width:0,height:a?o.height:0,edge:{id:t,source:r,target:n,attrs:o},dummy:!0,index:i})}function a(e){e.eachEdge(function(t,r,n,o){e.node(r).rank>e.node(n).rank&&(e.delEdge(t),o.reversed=!0,e.addEdge(t,n,r,o))})}function s(e,t){var r=l(e);t&&(u.log(1,"Using network simplex for ranking"),p(e,r)),d(e)}function d(e){var t=u.min(e.nodes().map(function(t){return e.node(t).rank}));e.eachNode(function(e,r){r.rank-=t})}var u=e("./util"),c=e("./rank/acyclic"),h=e("./rank/initRank"),l=e("./rank/feasibleTree"),f=e("./rank/constraints"),p=e("./rank/simplex"),g=e("graphlib").alg.components,v=e("graphlib").filter;r.run=function(e,t){n(e),u.time("constraints.apply",f.apply)(e),o(e),u.time("acyclic",c)(e);var r=e.filterNodes(u.filterNonSubgraphs(e));h(r),g(r).forEach(function(e){s(r.filterNodes(v.nodesFromList(e)),t)}),u.time("constraints.relax",f.relax(e)),u.time("reorientEdges",a)(e)},r.restoreEdges=function(e){c.undo(e)}},{"./rank/acyclic":21,"./rank/constraints":22,"./rank/feasibleTree":23,"./rank/initRank":24,"./rank/simplex":26,"./util":27,graphlib:29}],21:[function(e,t,r){"use strict";var n=e("../util");t.exports=function(e){function t(n){n in o||(o[n]=r[n]=!0,e.outEdges(n).forEach(function(o){var a,s=e.target(o);n===s?console.error('Warning: found self loop "'+o+'" for node "'+n+'"'):s in r?(a=e.edge(o),e.delEdge(o),a.reversed=!0,++i,e.addEdge(o,s,n,a)):t(s)}),delete r[n])}var r={},o={},i=0;return e.eachNode(function(e){t(e)}),n.log(2,"Acyclic Phase: reversed "+i+" edge(s)"),i},t.exports.undo=function(e){e.eachEdge(function(t,r,n,o){o.reversed&&(delete o.reversed,e.delEdge(t),e.addEdge(t,n,r,o))})}},{"../util":27}],22:[function(e,t,r){"use strict";function n(e){return"min"===e||"max"===e||0===e.indexOf("same_")||(console.error("Unsupported rank type: "+e),!1)}function o(e,t,r,n){e.inEdges(t).forEach(function(t){var o,i=e.edge(t);o=i.originalEdge?i:{originalEdge:{e:t,u:e.source(t),v:e.target(t),value:i},minLen:e.edge(t).minLen},i.selfLoop&&(n=!1),n?(e.addEdge(null,r,e.source(t),o),o.reversed=!0):e.addEdge(null,e.source(t),r,o)})}function i(e,t,r,n){e.outEdges(t).forEach(function(t){var o,i=e.edge(t);o=i.originalEdge?i:{originalEdge:{e:t,u:e.source(t),v:e.target(t),value:i},minLen:e.edge(t).minLen},i.selfLoop&&(n=!1),n?(e.addEdge(null,e.target(t),r,o),o.reversed=!0):e.addEdge(null,r,e.target(t),o)})}function a(e,t,r){void 0!==r&&e.children(t).forEach(function(t){t===r||e.outEdges(r,t).length||e.node(t).dummy||e.addEdge(null,r,t,{minLen:0})})}function s(e,t,r){void 0!==r&&e.children(t).forEach(function(t){t===r||e.outEdges(t,r).length||e.node(t).dummy||e.addEdge(null,t,r,{minLen:0})})}r.apply=function(e){function t(r){var d={};e.children(r).forEach(function(a){if(e.children(a).length)t(a);else{var s=e.node(a),u=s.prefRank;if(void 0!==u){if(!n(u))return;u in d?d.prefRank.push(a):d.prefRank=[a];var c=d[u];void 0===c&&(c=d[u]=e.addNode(null,{originalNodes:[]}),e.parent(c,r)),o(e,a,c,"min"===u),i(e,a,c,"max"===u),e.node(c).originalNodes.push({u:a,value:s,parent:r}),e.delNode(a)}}}),a(e,r,d.min),s(e,r,d.max)}t(null)},r.relax=function(e){var t=[];e.eachEdge(function(e,r,n,o){var i=o.originalEdge;i&&t.push(i)}),e.eachNode(function(t,r){var n=r.originalNodes;n&&(n.forEach(function(t){t.value.rank=r.rank,e.addNode(t.u,t.value),e.parent(t.u,t.parent)}),e.delNode(t))}),t.forEach(function(t){e.addEdge(t.e,t.u,t.v,t.value)})}},{}],23:[function(e,t,r){"use strict";function n(e,t,r){return e.node(r).rank-e.node(t).rank-a.max(e.outEdges(t,r).map(function(t){return e.edge(t).minLen}))}var o=e("cp-data").Set,i=e("graphlib").Digraph,a=e("../util");t.exports=function(e){function t(o){var i=!0;return e.predecessors(o).forEach(function(s){r.has(s)&&!n(e,s,o)&&(r.has(o)&&(a.addNode(o,{}),r.remove(o),a.graph({root:o})),a.addNode(s,{}),a.addEdge(null,s,o,{reversed:!0}),r.remove(s),t(s),i=!1)}),e.successors(o).forEach(function(s){r.has(s)&&!n(e,o,s)&&(r.has(o)&&(a.addNode(o,{}),r.remove(o),a.graph({root:o})),a.addNode(s,{}),a.addEdge(null,o,s,{}),r.remove(s),t(s),i=!1)}),i}var r=new o(e.nodes()),a=new i;if(1===r.size()){var s=e.nodes()[0];return a.addNode(s,{}),a.graph({root:s}),a}for(;r.size();){for(var d=a.order()?a.nodes():r.keys(),u=0,c=d.length;u<c&&t(d[u]);++u);r.size()&&function(){var t=Number.MAX_VALUE;r.keys().forEach(function(o){e.predecessors(o).forEach(function(i){if(!r.has(i)){var a=n(e,i,o);Math.abs(a)<Math.abs(t)&&(t=-a)}}),e.successors(o).forEach(function(i){if(!r.has(i)){var a=n(e,o,i);Math.abs(a)<Math.abs(t)&&(t=a)}})}),a.eachNode(function(r){e.node(r).rank-=t})}()}return a}},{"../util":27,"cp-data":5,graphlib:29}],24:[function(e,t,r){"use strict";var n=e("../util"),o=e("graphlib").alg.topsort;t.exports=function(e){o(e).forEach(function(t){var r=e.inEdges(t);if(0!==r.length){var o=r.map(function(t){return e.node(e.source(t)).rank+e.edge(t).minLen});e.node(t).rank=n.max(o)}else e.node(t).rank=0})}},{"../util":27,graphlib:29}],25:[function(e,t,r){"use strict";t.exports={slack:function(e,t,r,n){return Math.abs(e.node(t).rank-e.node(r).rank)-n}}},{}],26:[function(e,t,r){"use strict";function n(e,t){function r(n){var o=t.successors(n);for(var a in o)r(o[a]);n!==t.graph().root&&i(e,t,n)}o(t),t.eachEdge(function(e,t,r,n){n.cutValue=0}),r(t.graph().root)}function o(e){function t(n){var o=e.successors(n),i=r;for(var a in o){var s=o[a];t(s),i=Math.min(i,e.node(s).low)}e.node(n).low=i,e.node(n).lim=r++}var r=0;t(e.graph().root)}function i(e,t,r){var n=t.inEdges(r)[0],o=[],i=t.outEdges(r);for(var s in i)o.push(t.target(i[s]));var d,u=0,c=0,h=0,l=0,f=0,p=e.outEdges(r);for(var g in p){var v=e.target(p[g]);for(d in o)a(t,v,o[d])&&c++;a(t,v,r)||l++}var y=e.inEdges(r);for(var E in y){var m=e.source(y[E]);for(d in o)a(t,m,o[d])&&h++;a(t,m,r)||f++}var _=0;for(d in o){var b=t.edge(i[d]).cutValue;t.edge(i[d]).reversed?_-=b:_+=b}t.edge(n).reversed?u-=_-c+h-l+f:u+=_-c+h-l+f,t.edge(n).cutValue=u}function a(e,t,r){return e.node(r).low<=e.node(t).lim&&e.node(t).lim<=e.node(r).lim}function s(e){var t=e.edges();for(var r in t){var n=t[r];if(e.edge(n).cutValue<0)return n}return null}function d(e,t,r){var n,o=t.source(r),i=t.target(r),s=t.node(i).lim<t.node(o).lim?i:o,d=!t.edge(r).reversed,u=Number.POSITIVE_INFINITY;if(d?e.eachEdge(function(o,i,d,c){if(o!==r&&a(t,i,s)&&!a(t,d,s)){var h=f.slack(e,i,d,c.minLen);h<u&&(u=h,n=o)}}):e.eachEdge(function(o,i,d,c){if(o!==r&&!a(t,i,s)&&a(t,d,s)){var h=f.slack(e,i,d,c.minLen);h<u&&(u=h,n=o)}}),void 0===n){var c=[],h=[];throw e.eachNode(function(e){a(t,e,s)?h.push(e):c.push(e)}),new Error("No edge found from outside of tree to inside")}return n}function u(e,t,r,o){function i(e){var r=t.inEdges(e);for(var n in r){var o=r[n],a=t.source(o),s=t.edge(o);i(a),t.delEdge(o),s.reversed=!s.reversed,t.addEdge(o,e,a,s)}}t.delEdge(r);var a=e.source(o),s=e.target(o);i(s);for(var d=a,u=t.inEdges(d);u.length>0;)d=t.source(u[0]),u=t.inEdges(d);t.graph().root=d,t.addEdge(null,a,s,{cutValue:0}),n(e,t),c(e,t)}function c(e,t){function r(n){t.successors(n).forEach(function(t){var o=h(e,n,t);e.node(t).rank=e.node(n).rank+o,r(t)})}r(t.graph().root)}function h(e,t,r){var n=e.outEdges(t,r);if(n.length>0)return l.max(n.map(function(t){return e.edge(t).minLen}));var o=e.inEdges(t,r);return o.length>0?-l.max(o.map(function(t){return e.edge(t).minLen})):void 0}var l=e("../util"),f=e("./rankUtil");t.exports=function(e,t){for(n(e,t);;){var r=s(t);if(null===r)break;u(e,t,r,d(e,t,r))}}},{"../util":27,"./rankUtil":25}],27:[function(e,t,r){"use strict";function n(e,t){return function(){var r=(new Date).getTime();try{return t.apply(null,arguments)}finally{o(1,e+" time: "+((new Date).getTime()-r)+"ms")}}}function o(e){o.level>=e&&console.log.apply(console,Array.prototype.slice.call(arguments,1))}r.min=function(e){return Math.min.apply(Math,e)},r.max=function(e){return Math.max.apply(Math,e)},r.all=function(e,t){for(var r=0;r<e.length;++r)if(!t(e[r]))return!1;return!0},r.sum=function(e){return e.reduce(function(e,t){return e+t},0)},r.values=function(e){return Object.keys(e).map(function(t){return e[t]})},r.shuffle=function(e){for(var t=e.length-1;t>0;--t){var r=Math.floor(Math.random()*(t+1)),n=e[r];e[r]=e[t],e[t]=n}},r.propertyAccessor=function(e,t,r,n){return function(o){return arguments.length?(t[r]=o,n&&n(o),e):t[r]}},r.ordering=function(e){var t=[];return e.eachNode(function(e,r){(t[r.rank]||(t[r.rank]=[]))[r.order]=e}),t},r.filterNonSubgraphs=function(e){return function(t){return 0===e.children(t).length}},n.enabled=!1,r.time=n,o.level=0,r.log=o},{}],28:[function(e,t,r){t.exports="0.4.6"},{}],29:[function(e,t,r){r.Graph=e("./lib/Graph"),r.Digraph=e("./lib/Digraph"),r.CGraph=e("./lib/CGraph"),r.CDigraph=e("./lib/CDigraph"),e("./lib/graph-converters"),r.alg={isAcyclic:e("./lib/alg/isAcyclic"),components:e("./lib/alg/components"),dijkstra:e("./lib/alg/dijkstra"),dijkstraAll:e("./lib/alg/dijkstraAll"),findCycles:e("./lib/alg/findCycles"),floydWarshall:e("./lib/alg/floydWarshall"),postorder:e("./lib/alg/postorder"),preorder:e("./lib/alg/preorder"),prim:e("./lib/alg/prim"),tarjan:e("./lib/alg/tarjan"),topsort:e("./lib/alg/topsort")},r.converter={json:e("./lib/converter/json.js")};var n=e("./lib/filter");r.filter={all:n.all,nodesFromList:n.nodesFromList},r.version=e("./lib/version")},{"./lib/CDigraph":31,"./lib/CGraph":32,"./lib/Digraph":33,"./lib/Graph":34,"./lib/alg/components":35,"./lib/alg/dijkstra":36,"./lib/alg/dijkstraAll":37,"./lib/alg/findCycles":38,"./lib/alg/floydWarshall":39,"./lib/alg/isAcyclic":40,"./lib/alg/postorder":41,"./lib/alg/preorder":42,"./lib/alg/prim":43,"./lib/alg/tarjan":44,"./lib/alg/topsort":45,"./lib/converter/json.js":47,"./lib/filter":48,"./lib/graph-converters":49,"./lib/version":51}],30:[function(e,t,r){function n(){this._value=void 0,this._nodes={},this._edges={},this._nextId=0}function o(e,t,r){(e[t]||(e[t]=new a)).add(r)}function i(e,t,r){var n=e[t];n.remove(r),0===n.size()&&delete e[t]}var a=e("cp-data").Set;t.exports=n,n.prototype.order=function(){return Object.keys(this._nodes).length},n.prototype.size=function(){return Object.keys(this._edges).length},n.prototype.graph=function(e){if(0===arguments.length)return this._value;this._value=e},n.prototype.hasNode=function(e){return e in this._nodes},n.prototype.node=function(e,t){var r=this._strictGetNode(e);if(1===arguments.length)return r.value;r.value=t},n.prototype.nodes=function(){var e=[];return this.eachNode(function(t){e.push(t)}),e},n.prototype.eachNode=function(e){for(var t in this._nodes){var r=this._nodes[t];e(r.id,r.value)}},n.prototype.hasEdge=function(e){return e in this._edges},n.prototype.edge=function(e,t){var r=this._strictGetEdge(e);if(1===arguments.length)return r.value;r.value=t},n.prototype.edges=function(){var e=[];return this.eachEdge(function(t){e.push(t)}),e},n.prototype.eachEdge=function(e){for(var t in this._edges){var r=this._edges[t];e(r.id,r.u,r.v,r.value)}},n.prototype.incidentNodes=function(e){var t=this._strictGetEdge(e);return[t.u,t.v]},n.prototype.addNode=function(e,t){if(void 0===e||null===e)do{e="_"+ ++this._nextId}while(this.hasNode(e));else if(this.hasNode(e))throw new Error("Graph already has node '"+e+"'");return this._nodes[e]={id:e,value:t},e},n.prototype.delNode=function(e){this._strictGetNode(e),this.incidentEdges(e).forEach(function(e){this.delEdge(e)},this),delete this._nodes[e]},n.prototype._addEdge=function(e,t,r,n,i,a){if(this._strictGetNode(t),this._strictGetNode(r),void 0===e||null===e)do{e="_"+ ++this._nextId}while(this.hasEdge(e));else if(this.hasEdge(e))throw new Error("Graph already has edge '"+e+"'");return this._edges[e]={id:e,u:t,v:r,value:n},o(i[r],t,e),o(a[t],r,e),e},n.prototype._delEdge=function(e,t,r){var n=this._strictGetEdge(e);i(t[n.v],n.u,e),i(r[n.u],n.v,e),delete this._edges[e]},n.prototype.copy=function(){var e=new this.constructor;return e.graph(this.graph()),this.eachNode(function(t,r){e.addNode(t,r)}),this.eachEdge(function(t,r,n,o){e.addEdge(t,r,n,o)}),e._nextId=this._nextId,e},n.prototype.filterNodes=function(e){var t=new this.constructor;return t.graph(this.graph()),this.eachNode(function(r,n){e(r)&&t.addNode(r,n)}),this.eachEdge(function(e,r,n,o){t.hasNode(r)&&t.hasNode(n)&&t.addEdge(e,r,n,o)}),t},n.prototype._strictGetNode=function(e){var t=this._nodes[e];if(void 0===t)throw new Error("Node '"+e+"' is not in graph");return t},n.prototype._strictGetEdge=function(e){var t=this._edges[e];if(void 0===t)throw new Error("Edge '"+e+"' is not in graph");return t}},{"cp-data":5}],31:[function(e,t,r){var n=e("./Digraph"),o=e("./compoundify")(n);t.exports=o,o.fromDigraph=function(e){var t=new o,r=e.graph();return void 0!==r&&t.graph(r),e.eachNode(function(e,r){void 0===r?t.addNode(e):t.addNode(e,r)}),e.eachEdge(function(e,r,n,o){void 0===o?t.addEdge(null,r,n):t.addEdge(null,r,n,o)}),t},o.prototype.toString=function(){return"CDigraph "+JSON.stringify(this,null,2)}},{"./Digraph":33,"./compoundify":46}],32:[function(e,t,r){var n=e("./Graph"),o=e("./compoundify")(n);t.exports=o,o.fromGraph=function(e){var t=new o,r=e.graph();return void 0!==r&&t.graph(r),e.eachNode(function(e,r){void 0===r?t.addNode(e):t.addNode(e,r)}),e.eachEdge(function(e,r,n,o){void 0===o?t.addEdge(null,r,n):t.addEdge(null,r,n,o)}),t},o.prototype.toString=function(){return"CGraph "+JSON.stringify(this,null,2)}},{"./Graph":34,"./compoundify":46}],33:[function(e,t,r){function n(){i.call(this),this._inEdges={},this._outEdges={}}var o=e("./util"),i=e("./BaseGraph"),a=e("cp-data").Set;t.exports=n,(n.prototype=new i).constructor=n,n.prototype.isDirected=function(){return!0},n.prototype.successors=function(e){return this._strictGetNode(e),Object.keys(this._outEdges[e]).map(function(e){return this._nodes[e].id},this)},n.prototype.predecessors=function(e){return this._strictGetNode(e),Object.keys(this._inEdges[e]).map(function(e){return this._nodes[e].id},this)},n.prototype.neighbors=function(e){return a.union([this.successors(e),this.predecessors(e)]).keys()},n.prototype.sources=function(){var e=this;return this._filterNodes(function(t){return 0===e.inEdges(t).length})},n.prototype.sinks=function(){var e=this;return this._filterNodes(function(t){return 0===e.outEdges(t).length})},n.prototype.source=function(e){return this._strictGetEdge(e).u},n.prototype.target=function(e){return this._strictGetEdge(e).v},n.prototype.inEdges=function(e,t){this._strictGetNode(e);var r=a.union(o.values(this._inEdges[e])).keys();return arguments.length>1&&(this._strictGetNode(t),r=r.filter(function(e){return this.source(e)===t},this)),r},n.prototype.outEdges=function(e,t){this._strictGetNode(e);var r=a.union(o.values(this._outEdges[e])).keys();return arguments.length>1&&(this._strictGetNode(t),r=r.filter(function(e){return this.target(e)===t},this)),r},n.prototype.incidentEdges=function(e,t){return arguments.length>1?a.union([this.outEdges(e,t),this.outEdges(t,e)]).keys():a.union([this.inEdges(e),this.outEdges(e)]).keys()},n.prototype.toString=function(){return"Digraph "+JSON.stringify(this,null,2)},n.prototype.addNode=function(e,t){return e=i.prototype.addNode.call(this,e,t),this._inEdges[e]={},this._outEdges[e]={},e},n.prototype.delNode=function(e){i.prototype.delNode.call(this,e),delete this._inEdges[e],delete this._outEdges[e]},n.prototype.addEdge=function(e,t,r,n){return i.prototype._addEdge.call(this,e,t,r,n,this._inEdges,this._outEdges)},n.prototype.delEdge=function(e){i.prototype._delEdge.call(this,e,this._inEdges,this._outEdges)},n.prototype._filterNodes=function(e){var t=[];return this.eachNode(function(r){e(r)&&t.push(r)}),t}},{"./BaseGraph":30,"./util":50,"cp-data":5}],34:[function(e,t,r){function n(){i.call(this),this._incidentEdges={}}var o=e("./util"),i=e("./BaseGraph"),a=e("cp-data").Set;t.exports=n,(n.prototype=new i).constructor=n,n.prototype.isDirected=function(){return!1},n.prototype.neighbors=function(e){return this._strictGetNode(e),Object.keys(this._incidentEdges[e]).map(function(e){return this._nodes[e].id},this)},n.prototype.incidentEdges=function(e,t){return this._strictGetNode(e),arguments.length>1?(this._strictGetNode(t),t in this._incidentEdges[e]?this._incidentEdges[e][t].keys():[]):a.union(o.values(this._incidentEdges[e])).keys()},n.prototype.toString=function(){return"Graph "+JSON.stringify(this,null,2)},n.prototype.addNode=function(e,t){return e=i.prototype.addNode.call(this,e,t),this._incidentEdges[e]={},e},n.prototype.delNode=function(e){i.prototype.delNode.call(this,e),delete this._incidentEdges[e]},n.prototype.addEdge=function(e,t,r,n){return i.prototype._addEdge.call(this,e,t,r,n,this._incidentEdges,this._incidentEdges)},n.prototype.delEdge=function(e){i.prototype._delEdge.call(this,e,this._incidentEdges,this._incidentEdges)}},{"./BaseGraph":30,"./util":50,"cp-data":5}],35:[function(e,t,r){var n=e("cp-data").Set;t.exports=function(e){function t(r,n){o.has(r)||(o.add(r),n.push(r),e.neighbors(r).forEach(function(e){t(e,n)}))}var r=[],o=new n;return e.nodes().forEach(function(e){var n=[];t(e,n),n.length>0&&r.push(n)}),r}},{"cp-data":5}],36:[function(e,t,r){var n=e("cp-data").PriorityQueue;t.exports=function(e,t,r,o){var i={},a=new n;r=r||function(){return 1},o=o||(e.isDirected()?function(t){return e.outEdges(t)}:function(t){return e.incidentEdges(t)}),e.eachNode(function(e){var r=e===t?0:Number.POSITIVE_INFINITY;i[e]={distance:r},a.add(e,r)});for(var s,d;a.size()>0&&(s=a.removeMin(),(d=i[s]).distance!==Number.POSITIVE_INFINITY);)o(s).forEach(function(t){var n=e.incidentNodes(t),o=n[0]!==s?n[0]:n[1],u=i[o],c=r(t),h=d.distance+c;if(c<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+c);h<u.distance&&(u.distance=h,u.predecessor=s,a.decrease(o,h))});return i}},{"cp-data":5}],37:[function(e,t,r){var n=e("./dijkstra");t.exports=function(e,t,r){var o={};return e.eachNode(function(i){o[i]=n(e,i,t,r)}),o}},{"./dijkstra":36}],38:[function(e,t,r){var n=e("./tarjan");t.exports=function(e){return n(e).filter(function(e){return e.length>1})}},{"./tarjan":44}],39:[function(e,t,r){t.exports=function(e,t,r){var n={},o=e.nodes();return t=t||function(){return 1},r=r||(e.isDirected()?function(t){return e.outEdges(t)}:function(t){return e.incidentEdges(t)}),o.forEach(function(i){n[i]={},n[i][i]={distance:0},o.forEach(function(e){i!==e&&(n[i][e]={distance:Number.POSITIVE_INFINITY})}),r(i).forEach(function(r){var o=e.incidentNodes(r),a=o[0]!==i?o[0]:o[1],s=t(r);s<n[i][a].distance&&(n[i][a]={distance:s,predecessor:i})})}),o.forEach(function(e){var t=n[e];o.forEach(function(r){var i=n[r];o.forEach(function(r){var n=i[e],o=t[r],a=i[r],s=n.distance+o.distance;s<a.distance&&(a.distance=s,a.predecessor=o.predecessor)})})}),n}},{}],40:[function(e,t,r){var n=e("./topsort");t.exports=function(e){try{n(e)}catch(e){if(e instanceof n.CycleException)return!1;throw e}return!0}},{"./topsort":45}],41:[function(e,t,r){var n=e("cp-data").Set;t.exports=function(e,t,r){function o(t,n){if(i.has(t))throw new Error("The input graph is not a tree: "+e);i.add(t),e.neighbors(t).forEach(function(e){e!==n&&o(e,t)}),r(t)}var i=new n;if(e.isDirected())throw new Error("This function only works for undirected graphs");o(t)}},{"cp-data":5}],42:[function(e,t,r){var n=e("cp-data").Set;t.exports=function(e,t,r){function o(t,n){if(i.has(t))throw new Error("The input graph is not a tree: "+e);i.add(t),r(t),e.neighbors(t).forEach(function(e){e!==n&&o(e,t)})}var i=new n;if(e.isDirected())throw new Error("This function only works for undirected graphs");o(t)}},{"cp-data":5}],43:[function(e,t,r){var n=e("../Graph"),o=e("cp-data").PriorityQueue;t.exports=function(e,t){var r,i=new n,a={},s=new o;if(0===e.order())return i;e.eachNode(function(e){s.add(e,Number.POSITIVE_INFINITY),i.addNode(e)}),s.decrease(e.nodes()[0],0);for(var d=!1;s.size()>0;){if((r=s.removeMin())in a)i.addEdge(null,r,a[r]);else{if(d)throw new Error("Input graph is not connected: "+e);d=!0}e.incidentEdges(r).forEach(function(n){var o=e.incidentNodes(n),i=o[0]!==r?o[0]:o[1],d=s.priority(i);if(void 0!==d){var u=t(n);u<d&&(a[i]=r,s.decrease(i,u))}})}return i}},{"../Graph":34,"cp-data":5}],44:[function(e,t,r){t.exports=function(e){function t(a){var s=o[a]={onStack:!0,lowlink:r,index:r++};if(n.push(a),e.successors(a).forEach(function(e){e in o?o[e].onStack&&(s.lowlink=Math.min(s.lowlink,o[e].index)):(t(e),s.lowlink=Math.min(s.lowlink,o[e].lowlink))}),s.lowlink===s.index){var d,u=[];do{d=n.pop(),o[d].onStack=!1,u.push(d)}while(a!==d);i.push(u)}}if(!e.isDirected())throw new Error("tarjan can only be applied to a directed graph. Bad input: "+e);var r=0,n=[],o={},i=[];return e.nodes().forEach(function(e){e in o||t(e)}),i}},{}],45:[function(e,t,r){function n(e){function t(a){if(a in n)throw new o;a in r||(n[a]=!0,r[a]=!0,e.predecessors(a).forEach(function(e){t(e)}),delete n[a],i.push(a))}if(!e.isDirected())throw new Error("topsort can only be applied to a directed graph. Bad input: "+e);var r={},n={},i=[],a=e.sinks();if(0!==e.order()&&0===a.length)throw new o;return e.sinks().forEach(function(e){t(e)}),i}function o(){}t.exports=n,n.CycleException=o,o.prototype.toString=function(){return"Graph has at least one cycle"}},{}],46:[function(e,t,r){var n=e("cp-data").Set;t.exports=function(e){function t(){e.call(this),this._parents={},this._children={},this._children[null]=new n}return t.prototype=new e,t.prototype.constructor=t,t.prototype.parent=function(e,t){if(this._strictGetNode(e),arguments.length<2)return this._parents[e];if(e===t)throw new Error("Cannot make "+e+" a parent of itself");null!==t&&this._strictGetNode(t),this._children[this._parents[e]].remove(e),this._parents[e]=t,this._children[t].add(e)},t.prototype.children=function(e){return null!==e&&this._strictGetNode(e),this._children[e].keys()},t.prototype.addNode=function(t,r){return t=e.prototype.addNode.call(this,t,r),this._parents[t]=null,this._children[t]=new n,this._children[null].add(t),t},t.prototype.delNode=function(t){var r=this.parent(t);return this._children[t].keys().forEach(function(e){this.parent(e,r)},this),this._children[r].remove(t),delete this._parents[t],delete this._children[t],e.prototype.delNode.call(this,t)},t.prototype.copy=function(){var t=e.prototype.copy.call(this);return this.nodes().forEach(function(e){t.parent(e,this.parent(e))},this),t},t.prototype.filterNodes=function(t){function r(e){var t=n.parent(e);return null===t||o.hasNode(t)?(i[e]=t,t):t in i?i[t]:r(t)}var n=this,o=e.prototype.filterNodes.call(this,t),i={};return o.eachNode(function(e){o.parent(e,r(e))}),o},t}},{"cp-data":5}],47:[function(e,t,r){function n(e){return Object.prototype.toString.call(e).slice(8,-1)}var o=e("../Graph"),i=e("../Digraph"),a=e("../CGraph"),s=e("../CDigraph");r.decode=function(e,t,r){if(r=r||i,"Array"!==n(e))throw new Error("nodes is not an Array");if("Array"!==n(t))throw new Error("edges is not an Array");if("string"==typeof r)switch(r){case"graph":r=o;break;case"digraph":r=i;break;case"cgraph":r=a;break;case"cdigraph":r=s;break;default:throw new Error("Unrecognized graph type: "+r)}var d=new r;return e.forEach(function(e){d.addNode(e.id,e.value)}),d.parent&&e.forEach(function(e){e.children&&e.children.forEach(function(t){d.parent(t,e.id)})}),t.forEach(function(e){d.addEdge(e.id,e.u,e.v,e.value)}),d},r.encode=function(e){var t=[],r=[];e.eachNode(function(r,n){var o={id:r,value:n};if(e.children){var i=e.children(r);i.length&&(o.children=i)}t.push(o)}),e.eachEdge(function(e,t,n,o){r.push({id:e,u:t,v:n,value:o})});var n;if(e instanceof s)n="cdigraph";else if(e instanceof a)n="cgraph";else if(e instanceof i)n="digraph";else{if(!(e instanceof o))throw new Error("Couldn't determine type of graph: "+e);n="graph"}return{nodes:t,edges:r,type:n}}},{"../CDigraph":31,"../CGraph":32,"../Digraph":33,"../Graph":34}],48:[function(e,t,r){var n=e("cp-data").Set;r.all=function(){return function(){return!0}},r.nodesFromList=function(e){var t=new n(e);return function(e){return t.has(e)}}},{"cp-data":5}],49:[function(e,t,r){var n=e("./Graph"),o=e("./Digraph");n.prototype.toDigraph=n.prototype.asDirected=function(){var e=new o;return this.eachNode(function(t,r){e.addNode(t,r)}),this.eachEdge(function(t,r,n,o){e.addEdge(null,r,n,o),e.addEdge(null,n,r,o)}),e},o.prototype.toGraph=o.prototype.asUndirected=function(){var e=new n;return this.eachNode(function(t,r){e.addNode(t,r)}),this.eachEdge(function(t,r,n,o){e.addEdge(t,r,n,o)}),e}},{"./Digraph":33,"./Graph":34}],50:[function(e,t,r){r.values=function(e){var t,r=Object.keys(e),n=r.length,o=new Array(n);for(t=0;t<n;++t)o[t]=e[r[t]];return o}},{}],51:[function(e,t,r){t.exports="0.7.4"},{}]},{},[1]);